<%- include('partials/header') %>

<!-- Research Page -->
<section class="research-page">
  <div class="container">
    <h1>My Research</h1>
    <div class="research-grid">
      <% researchEntries.forEach(research => { %>
        <div class="research-card">
          <div class="pdf-cover">
            <% if (research.thumbnailFileId) { %>
              <!-- GridFS thumbnail takes priority -->
              <img src="/myresearch/thumbnail/<%= research.thumbnailFileId %>" alt="<%= research.title %> Preview" class="pdf-thumbnail">
            <% } else if (research.thumbnailUrl) { %>
              <img src="/<%= research.thumbnailUrl %>" alt="<%= research.title %> Preview" class="pdf-thumbnail">
            <% } else { %>
              <div class="pdf-placeholder">
                <i class="fas fa-file-pdf"></i>
                <span><%= research.title %></span>
              </div>
            <% } %>
          </div>

          <h3 class="research-title"><%= research.title %></h3>
          <p class="research-description"><%= research.description %></p>

          <div class="research-links">
            <% if (research.pdfFileId) { %>
              <!-- GridFS PDF (priority) -->
              <a href="/myresearch/pdf/<%= research.pdfFileId %>?dl=1" class="btn-link">
                <i class="fas fa-download"></i> Download PDF
              </a>
              <a href="/myresearch/pdf/<%= research.pdfFileId %>" target="_blank" class="btn-view">
                <i class="fas fa-eye"></i> View
              </a>
            <% } else if (research.researchPdf) { %>
              <!-- Legacy/local file fallback -->
              <a href="/<%= research.researchPdf %>" target="_blank" class="btn-link">
                <i class="fas fa-download"></i> Download PDF
              </a>
              <a href="/<%= research.researchPdf %>" target="_blank" class="btn-view">
                <i class="fas fa-eye"></i> View
              </a>
            <% } %>
          </div>
        </div>
      <% }) %>
    </div>
  </div>
</section>

<%- include('partials/footer') %>
